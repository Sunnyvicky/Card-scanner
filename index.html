<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Card Scanner - Â∞àÊ•≠‰∫∫ËÑàÁÆ°ÂÆ∂</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Card Scanner">
    <meta name="theme-color" content="#1e3a8a">

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background-color: #f8fafc; color: #1e293b; margin: 0; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 10; }
        @keyframes scan { 0% { top: 0%; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
        .scan-line { position: absolute; left: 0; width: 100%; height: 2px; background: #f97316; box-shadow: 0 0 10px #f97316; animation: scan 2s linear infinite; }
    </style>
</head>
<body>
    <div id="root">
        <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #f8fafc; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999;">
            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #3b82f6 0%, #1e3a8a 100%); border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; box-shadow: 0 10px 40px rgba(59, 130, 246, 0.3);">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                    <rect x="6" y="12" width="36" height="24" rx="2" fill="white"/>
                    <rect x="6" y="16" width="36" height="2" fill="#f97316"/>
                    <circle cx="16" cy="24" r="3" fill="#cbd5e1"/>
                    <rect x="22" y="22" width="14" height="2" rx="1" fill="#94a3b8"/>
                    <rect x="22" y="26" width="10" height="1.5" rx="0.75" fill="#e2e8f0"/>
                </svg>
            </div>
            <h1 style="font-size: 24px; font-weight: 900; color: #1e293b; margin-bottom: 8px;">CARD SCANNER</h1>
            <p style="font-size: 14px; color: #64748b;">‰∫∫ËÑàÔºåÊòØÊúÄÂ•ΩÁöÑË≥áÁî¢</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useRef, useEffect, useMemo } = React;

        const safeLS = {
            get: (k) => { try { return localStorage.getItem(k); } catch { return null; } },
            set: (k, v) => { try { localStorage.setItem(k, v); } catch {} },
            rm: (k) => { try { localStorage.removeItem(k); } catch {} }
        };

        const DB_NAME = 'CardScannerDB';
        const STORE = 'cards';
        
        const db = {
            open: () => new Promise((ok, fail) => {
                const r = indexedDB.open(DB_NAME, 1);
                r.onupgradeneeded = e => { const d = e.target.result; if (!d.objectStoreNames.contains(STORE)) d.createObjectStore(STORE, { keyPath: 'id' }); };
                r.onsuccess = e => ok(e.target.result);
                r.onerror = e => fail(e.target.error);
            }),
            getAll: async () => { const d = await db.open(); return new Promise((ok, fail) => { const t = d.transaction([STORE], 'readonly').objectStore(STORE).getAll(); t.onsuccess = () => ok(t.result); t.onerror = () => fail(t.error); }); },
            put: async (c) => { const d = await db.open(); return new Promise((ok, fail) => { const t = d.transaction([STORE], 'readwrite').objectStore(STORE).put(c); t.onsuccess = () => ok(); t.onerror = () => fail(t.error); }); },
            del: async (id) => { const d = await db.open(); return new Promise((ok, fail) => { const t = d.transaction([STORE], 'readwrite').objectStore(STORE).delete(id); t.onsuccess = () => ok(); t.onerror = () => fail(t.error); }); },
            clear: async () => { const d = await db.open(); return new Promise((ok, fail) => { const t = d.transaction([STORE], 'readwrite').objectStore(STORE).clear(); t.onsuccess = () => ok(); t.onerror = () => fail(t.error); }); }
        };

        const Icon = ({ name, size = 20, className = "" }) => {
            const ref = useRef(null);
            useEffect(() => {
                if (!ref.current || !window.lucide) return;
                ref.current.innerHTML = '';
                const i = document.createElement('i');
                i.setAttribute('data-lucide', name);
                ref.current.appendChild(i);
                window.lucide.createIcons({ root: ref.current, attrs: { width: size, height: size, class: className } });
            }, [name, size, className]);
            return <span ref={ref} style={{ display: 'inline-flex' }}></span>;
        };

        const compress = (file) => new Promise((ok, fail) => {
            if (!file) return fail("ÁÑ°Ê™îÊ°à");
            const url = URL.createObjectURL(file);
            const img = new Image();
            img.src = url;
            img.onload = () => {
                URL.revokeObjectURL(url);
                const c = document.createElement('canvas');
                const MAX = 1200;
                let w = img.width, h = img.height;
                if (w > h && w > MAX) { h *= MAX / w; w = MAX; }
                else if (h > MAX) { w *= MAX / h; h = MAX; }
                c.width = w; c.height = h;
                c.getContext('2d').drawImage(img, 0, 0, w, h);
                ok(c.toDataURL('image/jpeg', 0.85));
            };
            img.onerror = fail;
        });

        const Camera = ({ onCapture, onCancel }) => {
            const videoRef = useRef(null);
            const [err, setErr] = useState(null);
            
            useEffect(() => {
                let stream = null;
                const start = async () => {
                    try {
                        stream = await navigator.mediaDevices.getUserMedia({ 
                            video: { facingMode: "environment", width: { ideal: 1920 }, height: { ideal: 1080 } }, 
                            audio: false 
                        });
                        if (videoRef.current) { videoRef.current.srcObject = stream; videoRef.current.play().catch(console.error); }
                    } catch (e) { setErr("ÁÑ°Ê≥ïÂïüÂãïÁõ∏Ê©ü"); }
                };
                start();
                return () => { if (stream) stream.getTracks().forEach(t => t.stop()); };
            }, []);
            
            const capture = () => {
                if (!videoRef.current) return;
                const v = videoRef.current;
                const c = document.createElement("canvas");
                const vRatio = v.videoWidth / v.videoHeight;
                const dRatio = v.clientWidth / v.clientHeight;
                let sx = 0, sy = 0, sw = v.videoWidth, sh = v.videoHeight;
                if (vRatio > dRatio) { sw = v.videoHeight * dRatio; sx = (v.videoWidth - sw) / 2; }
                else { sh = v.videoWidth / dRatio; sy = (v.videoHeight - sh) / 2; }
                const frameW = sw * 0.75, frameH = frameW / 1.6;
                const fx = sx + (sw - frameW) / 2, fy = sy + (sh - frameH) / 2;
                c.width = Math.min(frameW, 1600);
                c.height = Math.min(frameH, 1000);
                c.getContext('2d').drawImage(v, fx, fy, frameW, frameH, 0, 0, c.width, c.height);
                onCapture(c.toDataURL("image/jpeg", 0.9));
            };

            return (
                <div className="fixed inset-0 bg-black z-50 flex flex-col">
                    <div className="flex-1 relative">
                        <video ref={videoRef} playsInline muted autoPlay className="w-full h-full object-cover" />
                        {err && <div className="absolute inset-0 flex items-center justify-center text-white bg-black/80">{err}</div>}
                        <div className="absolute inset-0 flex items-center justify-center pointer-events-none z-20">
                            <div className="w-3/4 aspect-[1.6/1] border-2 border-blue-500 rounded-xl relative shadow-[0_0_0_999px_rgba(0,0,0,0.5)]">
                                <div className="scan-line"></div>
                                <div className="absolute top-0 left-0 w-4 h-4 border-t-4 border-l-4 border-blue-500 -mt-1 -ml-1"></div>
                                <div className="absolute top-0 right-0 w-4 h-4 border-t-4 border-r-4 border-blue-500 -mt-1 -mr-1"></div>
                                <div className="absolute bottom-0 left-0 w-4 h-4 border-b-4 border-l-4 border-blue-500 -mb-1 -ml-1"></div>
                                <div className="absolute bottom-0 right-0 w-4 h-4 border-b-4 border-r-4 border-blue-500 -mb-1 -mr-1"></div>
                            </div>
                        </div>
                        <div className="absolute bottom-32 w-full text-center z-20"><span className="px-4 py-2 bg-black/50 text-white text-xs rounded-full">ÊãçÁÖßÂæåÂèØÊâãÂãïËº∏ÂÖ•Ë≥áÊñô</span></div>
                    </div>
                    <div className="h-32 bg-black flex items-center justify-center gap-8 z-30">
                        <button onClick={onCancel} className="text-white font-bold p-4">ÂèñÊ∂à</button>
                        <button onClick={capture} className="w-16 h-16 bg-white rounded-full border-4 border-gray-300 active:scale-95 transition"></button>
                        <div className="w-12"></div>
                    </div>
                </div>
            );
        };

        function App() {
            const [splash, setSplash] = useState(true);
            const [view, setView] = useState("home");
            const [cards, setCards] = useState([]);
            const [img, setImg] = useState(null);
            const [avatar, setAvatar] = useState(null);
            const [data, setData] = useState({});
            const [cardId, setCardId] = useState(null);
            const [cat, setCat] = useState("ÂÖ®ÈÉ®");
            const [q, setQ] = useState("");

            useEffect(() => { setTimeout(() => setSplash(false), 2000); }, []);
            useEffect(() => { db.getAll().then(c => setCards(c.sort((a, b) => b.id - a.id))).catch(console.error); }, []);
            useEffect(() => { setTimeout(() => { if (window.lucide) window.lucide.createIcons(); }, 50); }, [view, cards, cat]);

            const onScan = (b64) => { 
                setImg(b64); 
                setData({ category: "Â∑•‰Ωú" });
                setCardId(null); 
                setAvatar(null);
                setView("result"); 
            };

            const save = async () => {
                const d = { id: cardId || Date.now(), ...data, image: img, avatar, category: data.category || "Â∑•‰Ωú" };
                try {
                    await db.put(d);
                    if (cardId) setCards(p => p.map(c => c.id === cardId ? d : c));
                    else setCards(p => [d, ...p]);
                    setView("home");
                } catch { alert("ÂÑ≤Â≠òÂ§±Êïó"); }
            };

            const del = async (id, e) => {
                e.stopPropagation();
                if (confirm("Á¢∫ÂÆöÂà™Èô§Ôºü")) {
                    try { await db.del(id); setCards(p => p.filter(c => c.id !== id)); } catch {}
                }
            };

            const upload = async (e, set) => {
                if (e.target.files[0]) {
                    try { set(await compress(e.target.files[0])); } catch { alert("ËôïÁêÜÂ§±Êïó"); }
                }
            };

            const viewCard = (c) => {
                setData(c); setImg(c.image); setAvatar(c.avatar); setCardId(c.id);
                setView("result");
            };

            const filtered = useMemo(() => {
                let r = cat === "ÂÖ®ÈÉ®" ? cards : cards.filter(c => c.category === cat);
                if (q) r = r.filter(c => c.name?.toLowerCase().includes(q.toLowerCase()) || c.company?.toLowerCase().includes(q.toLowerCase()));
                return r;
            }, [cards, cat, q]);

            const exp = () => {
                if (cards.length === 0) { alert("ÁÑ°Ë≥áÊñô"); return; }
                const blob = new Blob([JSON.stringify(cards, null, 2)], { type: "application/json" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url; a.download = `cards_${Date.now()}.json`; a.click();
                URL.revokeObjectURL(url);
            };

            const imp = (e) => {
                const f = e.target.files[0];
                if (!f) return;
                const r = new FileReader();
                r.onload = async e => {
                    try {
                        const d = JSON.parse(e.target.result);
                        if (Array.isArray(d) && confirm(`ÂåØÂÖ• ${d.length} Á≠ÜÔºü`)) {
                            for (const c of d) await db.put(c);
                            setCards((await db.getAll()).sort((a, b) => b.id - a.id));
                            alert("ÊàêÂäü");
                        }
                    } catch { alert("Ê†ºÂºèÈåØË™§"); }
                };
                r.readAsText(f);
                e.target.value = '';
            };

            if (splash) {
                return (
                    <div className="fixed inset-0 bg-[#f8fafc] z-[9999] flex flex-col items-center justify-center">
                        <div style={{ width: '80px', height: '80px', background: 'linear-gradient(135deg, #3b82f6 0%, #1e3a8a 100%)', borderRadius: '20px', display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '20px', boxShadow: '0 10px 40px rgba(59, 130, 246, 0.3)' }}>
                            <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                <rect x="6" y="12" width="36" height="24" rx="2" fill="white"/>
                                <rect x="6" y="16" width="36" height="2" fill="#f97316"/>
                                <circle cx="16" cy="24" r="3" fill="#cbd5e1"/>
                                <rect x="22" y="22" width="14" height="2" rx="1" fill="#94a3b8"/>
                                <rect x="22" y="26" width="10" height="1.5" rx="0.75" fill="#e2e8f0"/>
                            </svg>
                        </div>
                        <h1 style={{ fontSize: '24px', fontWeight: '900', color: '#1e293b', marginBottom: '8px' }}>CARD SCANNER</h1>
                        <p style={{ fontSize: '14px', color: '#64748b' }}>‰∫∫ËÑàÔºåÊòØÊúÄÂ•ΩÁöÑË≥áÁî¢</p>
                    </div>
                );
            }

            return (
                <div className="max-w-md mx-auto h-screen bg-gray-50 flex flex-col">
                    <header className="px-6 pt-12 pb-4 bg-white shadow-sm flex justify-between items-center">
                        <h1 className="text-xl font-black text-blue-600">CARD SCANNER</h1>
                        <button onClick={() => setView("settings")} className="text-gray-400"><Icon name="settings" /></button>
                    </header>

                    <main className="flex-1 overflow-y-auto p-4">
                        {view === "home" && (
                            <div className="space-y-4">
                                <div className="bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-xl border border-blue-100">
                                    <p className="text-sm text-gray-600 text-center">üí° ÊãçÁÖßÂæåÊâãÂãïËº∏ÂÖ•Ë≥áÊñôÔºåÂäüËÉΩÂÆåÊï¥‰∏çÊâìÊäòÔºÅ</p>
                                </div>
                                
                                <div className="relative">
                                    <div className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><Icon name="search" size={16} /></div>
                                    <input type="text" placeholder="ÊêúÂ∞ãÂßìÂêçÊàñÂÖ¨Âè∏..." className="w-full bg-white border rounded-xl pl-10 pr-4 py-3 text-sm shadow-sm" value={q} onChange={e => setQ(e.target.value)} />
                                </div>

                                <div className="flex gap-2 overflow-x-auto hide-scrollbar pb-2">
                                    {["ÂÖ®ÈÉ®", "Â∑•‰Ωú", "ÂÆ∂‰∫∫", "ÂêåÂ≠∏", "ÊúãÂèã"].map(c => (
                                        <button key={c} onClick={() => setCat(c)} className={`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-all ${cat === c ? "bg-blue-600 text-white shadow-md scale-105" : "bg-white text-gray-500 border hover:border-blue-300"}`}>{c}</button>
                                    ))}
                                </div>

                                {filtered.length === 0 ? (
                                    <div className="text-center py-20">
                                        <div className="text-6xl mb-4">üìá</div>
                                        <p className="text-gray-400 text-sm">Êö´ÁÑ°ÂêçÁâá</p>
                                        <p className="text-gray-300 text-xs mt-2">ÈªûÊìä‰∏ãÊñπÊåâÈàïÈñãÂßãÊñ∞Â¢û</p>
                                    </div>
                                ) : (
                                    filtered.map(c => (
                                        <div key={c.id} onClick={() => viewCard(c)} className="bg-white rounded-xl p-4 shadow-sm flex gap-4 items-center active:scale-[0.98] transition-all hover:shadow-md border border-gray-100">
                                            {c.avatar ? 
                                                <img src={c.avatar} className="w-14 h-14 rounded-xl object-cover border-2 border-blue-100" /> : 
                                                <div className="w-14 h-14 rounded-xl bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-bold text-xl shadow-md">{c.name?.[0] || "?"}</div>
                                            }
                                            <div className="flex-1 min-w-0">
                                                <div className="font-bold text-gray-800 truncate">{c.name || "Êú™ÂëΩÂêç"}</div>
                                                <div className="text-sm text-gray-500 truncate">{c.company || c.jobTitle || "ÁÑ°ÂÖ¨Âè∏Ë≥áË®ä"}</div>
                                                {c.mobile && <div className="text-xs text-blue-600 mt-1">üì± {c.mobile}</div>}
                                            </div>
                                            <button onClick={e => del(c.id, e)} className="p-2 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition"><Icon name="trash-2" size={18} /></button>
                                        </div>
                                    ))
                                )}
                            </div>
                        )}

                        {view === "settings" && (
                            <div className="space-y-4">
                                <div className="bg-white p-5 rounded-xl shadow-sm border border-gray-100">
                                    <h3 className="font-bold mb-4 flex items-center gap-2"><Icon name="database" className="text-blue-500"/>Ë≥áÊñôÁÆ°ÁêÜ</h3>
                                    <div className="space-y-3">
                                        <button onClick={exp} className="w-full bg-gradient-to-r from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100 p-4 rounded-xl flex justify-between items-center transition border border-green-200">
                                            <span className="font-medium text-green-700">ÂåØÂá∫ÂÇô‰ªΩ</span>
                                            <Icon name="download" size={20} className="text-green-600"/>
                                        </button>
                                        <label className="w-full bg-gradient-to-r from-orange-50 to-amber-50 hover:from-orange-100 hover:to-amber-100 p-4 rounded-xl flex justify-between items-center cursor-pointer transition border border-orange-200">
                                            <span className="font-medium text-orange-700">ÂåØÂÖ•ÂÇô‰ªΩ</span>
                                            <Icon name="upload" size={20} className="text-orange-600"/>
                                            <input type="file" accept=".json" onChange={imp} className="hidden" />
                                        </label>
                                        <button onClick={async () => { if (confirm("Á¢∫ÂÆöÊ∏ÖÁ©∫ÊâÄÊúâË≥áÊñôÔºü")) { await db.clear(); setCards([]); alert("Â∑≤Ê∏ÖÁ©∫"); } }} className="w-full bg-gradient-to-r from-red-50 to-pink-50 hover:from-red-100 hover:to-pink-100 p-4 rounded-xl flex justify-between items-center transition border border-red-200">
                                            <span className="font-medium text-red-700">Ê∏ÖÁ©∫ÊâÄÊúâË≥áÊñô</span>
                                            <Icon name="trash" size={20} className="text-red-600"/>
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200">
                                    <p className="text-xs text-gray-600 text-center">üì± Ë≥áÊñôÂÑ≤Â≠òÊñºÊú¨Ê©üÔºåÂÆâÂÖ®ÂèØÈù†</p>
                                </div>
                                
                                <button onClick={() => setView("home")} className="w-full bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-xl font-bold transition">ËøîÂõûÈ¶ñÈ†Å</button>
                            </div>
                        )}

                        {view === "result" && (
                            <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100">
                                <div className="bg-gradient-to-br from-gray-50 to-gray-100 relative group">
                                    {img ? 
                                        <img src={img} className="w-full object-contain max-h-72" /> : 
                                        <div className="h-48 flex items-center justify-center text-gray-300">
                                            <div className="text-center">
                                                <Icon name="image" size={48} className="mx-auto mb-2"/>
                                                <p className="text-sm">ÁÑ°ÂêçÁâáÁÖßÁâá</p>
                                            </div>
                                        </div>
                                    }
                                    <label className="absolute bottom-3 right-3 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full cursor-pointer shadow-lg transition opacity-0 group-hover:opacity-100">
                                        <Icon name="camera" size={18}/>
                                        <input type="file" accept="image/*" className="hidden" onChange={e => upload(e, setImg)} />
                                    </label>
                                </div>
                                
                                <div className="p-6 space-y-5">
                                    <div className="flex gap-4 items-start">
                                        <div className="relative">
                                            {avatar ? 
                                                <img src={avatar} className="w-24 h-24 rounded-2xl object-cover border-2 border-blue-200 shadow-md" /> : 
                                                <div className="w-24 h-24 rounded-2xl bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center border-2 border-blue-300">
                                                    <Icon name="user" size={40} className="text-blue-600" />
                                                </div>
                                            }
                                            <label className="absolute -bottom-2 -right-2 bg-white shadow-lg p-2 rounded-full cursor-pointer border-2 border-blue-200 hover:border-blue-400 transition">
                                                <Icon name="edit-2" size={14} className="text-blue-600" />
                                                <input type="file" accept="image/*" className="hidden" onChange={e => upload(e, setAvatar)} />
                                            </label>
                                        </div>
                                        <div className="flex-1 space-y-3">
                                            <input type="text" value={data.name || ""} onChange={e => setData({...data, name: e.target.value})} placeholder="ÂßìÂêç" className="w-full text-2xl font-black bg-transparent border-b-2 border-gray-200 focus:border-blue-500 outline-none pb-2 placeholder-gray-300" />
                                            <input type="text" value={data.jobTitle || ""} onChange={e => setData({...data, jobTitle: e.target.value})} placeholder="ËÅ∑Á®±" className="w-full text-sm text-gray-600 bg-transparent border-b border-gray-200 focus:border-blue-500 outline-none pb-2 placeholder-gray-300" />
                                        </div>
                                    </div>

                                    <div className="space-y-3">
                                        {[
                                            { icon: "building", key: "company", placeholder: "ÂÖ¨Âè∏ÂêçÁ®±", color: "purple" },
                                            { icon: "smartphone", key: "mobile", placeholder: "ÊâãÊ©üËôüÁ¢º", color: "green" },
                                            { icon: "phone", key: "tel", placeholder: "ÂÖ¨Âè∏ÈõªË©±", color: "blue" },
                                            { icon: "mail", key: "email", placeholder: "Email", color: "red" },
                                            { icon: "map-pin", key: "address", placeholder: "Âú∞ÂùÄ", color: "orange" },
                                        ].map(f => (
                                            <div key={f.key} className="flex items-center gap-3 bg-gradient-to-r from-gray-50 to-white p-4 rounded-xl border border-gray-100 hover:border-blue-200 transition">
                                                <Icon name={f.icon} className={`text-${f.color}-500`} size={20} />
                                                <input type="text" value={data[f.key] || ""} onChange={e => setData({...data, [f.key]: e.target.value})} placeholder={f.placeholder} className="flex-1 bg-transparent text-sm outline-none placeholder-gray-400" />
                                            </div>
                                        ))}
                                        
                                        <div className="grid grid-cols-4 gap-2 pt-2">
                                            {["Â∑•‰Ωú", "ÂÆ∂‰∫∫", "ÂêåÂ≠∏", "ÊúãÂèã"].map(c => (
                                                <button key={c} onClick={() => setData({...data, category: c})} className={`py-3 text-sm rounded-xl font-bold transition-all ${data.category === c ? "bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg scale-105" : "bg-gray-100 text-gray-500 hover:bg-gray-200"}`}>{c}</button>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="flex gap-3 pt-4">
                                        <button onClick={() => setView("home")} className="flex-1 py-4 rounded-xl font-bold bg-gray-100 hover:bg-gray-200 text-gray-700 transition">ÂèñÊ∂à</button>
                                        <button onClick={save} className="flex-[2] py-4 rounded-xl font-bold text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg transition">üíæ ÂÑ≤Â≠òÂêçÁâá</button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {view === "home" && (
                        <div className="absolute bottom-8 left-0 w-full flex justify-center z-20 pointer-events-none">
                            <div className="flex gap-8 bg-white px-8 py-4 rounded-full shadow-2xl pointer-events-auto border-2 border-gray-100">
                                <button onClick={() => setView("scan")} className="relative -top-8">
                                    <div className="w-20 h-20 bg-gradient-to-br from-blue-600 to-blue-700 rounded-3xl flex items-center justify-center shadow-2xl border-4 border-white hover:scale-110 transition-transform">
                                        <Icon name="camera" size={36} className="text-white" />
                                    </div>
                                </button>
                                <button onClick={() => { setData({ category: "Â∑•‰Ωú" }); setImg(null); setAvatar(null); setCardId(null); setView("result"); }} className="flex flex-col items-center gap-1 text-gray-500 hover:text-blue-600 transition">
                                    <div className="w-12 h-12 rounded-2xl bg-gray-100 hover:bg-blue-50 flex items-center justify-center transition">
                                        <Icon name="edit" size={22} />
                                    </div>
                                    <span className="text-xs font-bold">Áõ¥Êé•Ëº∏ÂÖ•</span>
                                </button>
                            </div>
                        </div>
                    )}

                    {view === "scan" && <Camera onCapture={onScan} onCancel={() => setView("home")} />}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
